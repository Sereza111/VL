{"ast":null,"code":"import React,{useEffect,useRef}from'react';import{jsx as _jsx}from\"react/jsx-runtime\";const MagicCircleVFX=_ref=>{let{show=false,color='#A8C7FA',duration=1200}=_ref;const canvasRef=useRef(null);const rafRef=useRef(0);useEffect(()=>{const canvas=canvasRef.current;if(!canvas)return;const ctx=canvas.getContext('2d');let t0=0;let running=false;const dpr=Math.min(2,window.devicePixelRatio||1);const resize=()=>{canvas.width=window.innerWidth*dpr;canvas.height=window.innerHeight*dpr;canvas.style.width=window.innerWidth+'px';canvas.style.height=window.innerHeight+'px';ctx.setTransform(dpr,0,0,dpr,0,0);};const render=time=>{if(!running)return;if(!t0)t0=time;const elapsed=time-t0;const p=Math.min(1,elapsed/duration);ctx.clearRect(0,0,canvas.width,canvas.height);const cx=window.innerWidth/2;const cy=window.innerHeight/2;const baseR=Math.min(cx,cy)*0.35;// Outer fading circle\nctx.save();ctx.globalAlpha=0.6*(1-p);ctx.strokeStyle=color;ctx.lineWidth=2;ctx.beginPath();ctx.arc(cx,cy,baseR*(0.9+p*0.2),0,Math.PI*2);ctx.stroke();ctx.restore();// Rotating runes\nconst rings=3;for(let r=0;r<rings;r++){const rr=baseR*(0.4+r*0.2);ctx.save();ctx.translate(cx,cy);ctx.rotate((r%2===0?1:-1)*time/1200);ctx.globalAlpha=0.9-r*0.25;ctx.strokeStyle=color;ctx.lineWidth=1;ctx.beginPath();for(let i=0;i<12;i++){const a0=i/12*Math.PI*2;ctx.moveTo(Math.cos(a0)*(rr-6),Math.sin(a0)*(rr-6));ctx.lineTo(Math.cos(a0)*(rr+6),Math.sin(a0)*(rr+6));}ctx.stroke();ctx.restore();}if(p<1)rafRef.current=requestAnimationFrame(render);};const start=()=>{running=true;t0=0;rafRef.current=requestAnimationFrame(render);};const stop=()=>{running=false;cancelAnimationFrame(rafRef.current);ctx.clearRect(0,0,canvas.width,canvas.height);};window.addEventListener('resize',resize);resize();if(show)start();else stop();return()=>{window.removeEventListener('resize',resize);stop();};},[show,color,duration]);return/*#__PURE__*/_jsx(\"canvas\",{ref:canvasRef,style:{position:'fixed',inset:0,zIndex:900,pointerEvents:'none'},\"aria-hidden\":true});};export default/*#__PURE__*/React.memo(MagicCircleVFX);","map":{"version":3,"names":["React","useEffect","useRef","jsx","_jsx","MagicCircleVFX","_ref","show","color","duration","canvasRef","rafRef","canvas","current","ctx","getContext","t0","running","dpr","Math","min","window","devicePixelRatio","resize","width","innerWidth","height","innerHeight","style","setTransform","render","time","elapsed","p","clearRect","cx","cy","baseR","save","globalAlpha","strokeStyle","lineWidth","beginPath","arc","PI","stroke","restore","rings","r","rr","translate","rotate","i","a0","moveTo","cos","sin","lineTo","requestAnimationFrame","start","stop","cancelAnimationFrame","addEventListener","removeEventListener","ref","position","inset","zIndex","pointerEvents","memo"],"sources":["/var/www/www-root/data/www/knigavl.ru/src/components/MagicCircleVFX.js"],"sourcesContent":["import React, { useEffect, useRef } from 'react';\r\n\r\nconst MagicCircleVFX = ({ show = false, color = '#A8C7FA', duration = 1200 }) => {\r\n  const canvasRef = useRef(null);\r\n  const rafRef = useRef(0);\r\n\r\n  useEffect(() => {\r\n    const canvas = canvasRef.current;\r\n    if (!canvas) return;\r\n    const ctx = canvas.getContext('2d');\r\n    let t0 = 0;\r\n    let running = false;\r\n\r\n    const dpr = Math.min(2, window.devicePixelRatio || 1);\r\n    const resize = () => {\r\n      canvas.width = window.innerWidth * dpr;\r\n      canvas.height = window.innerHeight * dpr;\r\n      canvas.style.width = window.innerWidth + 'px';\r\n      canvas.style.height = window.innerHeight + 'px';\r\n      ctx.setTransform(dpr, 0, 0, dpr, 0, 0);\r\n    };\r\n    const render = (time) => {\r\n      if (!running) return;\r\n      if (!t0) t0 = time;\r\n      const elapsed = time - t0;\r\n      const p = Math.min(1, elapsed / duration);\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n      const cx = window.innerWidth / 2;\r\n      const cy = window.innerHeight / 2;\r\n      const baseR = Math.min(cx, cy) * 0.35;\r\n      // Outer fading circle\r\n      ctx.save();\r\n      ctx.globalAlpha = 0.6 * (1 - p);\r\n      ctx.strokeStyle = color;\r\n      ctx.lineWidth = 2;\r\n      ctx.beginPath();\r\n      ctx.arc(cx, cy, baseR * (0.9 + p * 0.2), 0, Math.PI * 2);\r\n      ctx.stroke();\r\n      ctx.restore();\r\n      // Rotating runes\r\n      const rings = 3;\r\n      for (let r = 0; r < rings; r++) {\r\n        const rr = baseR * (0.4 + r * 0.2);\r\n        ctx.save();\r\n        ctx.translate(cx, cy);\r\n        ctx.rotate(((r % 2 === 0 ? 1 : -1) * time) / 1200);\r\n        ctx.globalAlpha = 0.9 - r * 0.25;\r\n        ctx.strokeStyle = color;\r\n        ctx.lineWidth = 1;\r\n        ctx.beginPath();\r\n        for (let i = 0; i < 12; i++) {\r\n          const a0 = (i / 12) * Math.PI * 2;\r\n          ctx.moveTo(Math.cos(a0) * (rr - 6), Math.sin(a0) * (rr - 6));\r\n          ctx.lineTo(Math.cos(a0) * (rr + 6), Math.sin(a0) * (rr + 6));\r\n        }\r\n        ctx.stroke();\r\n        ctx.restore();\r\n      }\r\n      if (p < 1) rafRef.current = requestAnimationFrame(render);\r\n    };\r\n    const start = () => {\r\n      running = true;\r\n      t0 = 0;\r\n      rafRef.current = requestAnimationFrame(render);\r\n    };\r\n    const stop = () => {\r\n      running = false;\r\n      cancelAnimationFrame(rafRef.current);\r\n      ctx.clearRect(0, 0, canvas.width, canvas.height);\r\n    };\r\n    window.addEventListener('resize', resize);\r\n    resize();\r\n    if (show) start(); else stop();\r\n    return () => { window.removeEventListener('resize', resize); stop(); };\r\n  }, [show, color, duration]);\r\n\r\n  return (\r\n    <canvas \r\n      ref={canvasRef} \r\n      style={{ position:'fixed', inset:0, zIndex: 900, pointerEvents:'none' }}\r\n      aria-hidden\r\n    />\r\n  );\r\n};\r\n\r\nexport default React.memo(MagicCircleVFX);\r\n\r\n\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}