{"ast":null,"code":"// src/services/storage.js\nexport const saveUserData=async(userId,data)=>{try{var _window$Telegram,_window$Telegram$WebA;const key=\"vl_\".concat(userId);const serializedData=JSON.stringify(data);// Используем Telegram Cloud Storage если доступен\nif((_window$Telegram=window.Telegram)!==null&&_window$Telegram!==void 0&&(_window$Telegram$WebA=_window$Telegram.WebApp)!==null&&_window$Telegram$WebA!==void 0&&_window$Telegram$WebA.CloudStorage){await new Promise((resolve,reject)=>{window.Telegram.WebApp.CloudStorage.setItem(key,serializedData,error=>{if(error){reject(error);}else{resolve();}});});}else{// Локальное хранилище для разработки\nlocalStorage.setItem(key,serializedData);}return true;}catch(error){console.error('Ошибка сохранения данных:',error);return false;}};export const loadUserData=async userId=>{try{var _window$Telegram2,_window$Telegram2$Web;const key=\"vl_\".concat(userId);// Используем Telegram Cloud Storage если доступен\nif((_window$Telegram2=window.Telegram)!==null&&_window$Telegram2!==void 0&&(_window$Telegram2$Web=_window$Telegram2.WebApp)!==null&&_window$Telegram2$Web!==void 0&&_window$Telegram2$Web.CloudStorage){const value=await new Promise((resolve,reject)=>{window.Telegram.WebApp.CloudStorage.getItem(key,(error,result)=>{if(error){reject(error);}else{resolve(result);}});});return value?JSON.parse(value):null;}// Локальное хранилище для разработки\nconst localData=localStorage.getItem(key);return localData?JSON.parse(localData):null;}catch(error){console.error('Ошибка загрузки данных:',error);return null;}};","map":{"version":3,"names":["saveUserData","userId","data","_window$Telegram","_window$Telegram$WebA","key","concat","serializedData","JSON","stringify","window","Telegram","WebApp","CloudStorage","Promise","resolve","reject","setItem","error","localStorage","console","loadUserData","_window$Telegram2","_window$Telegram2$Web","value","getItem","result","parse","localData"],"sources":["/var/www/www-root/data/www/knigavl.ru/src/services/storage.js"],"sourcesContent":["// src/services/storage.js\nexport const saveUserData = async (userId, data) => {\n  try {\n    const key = `vl_${userId}`;\n    const serializedData = JSON.stringify(data);\n\n    // Используем Telegram Cloud Storage если доступен\n    if (window.Telegram?.WebApp?.CloudStorage) {\n      await new Promise((resolve, reject) => {\n        window.Telegram.WebApp.CloudStorage.setItem(key, serializedData, (error) => {\n          if (error) {\n            reject(error);\n          } else {\n            resolve();\n          }\n        });\n      });\n    } else {\n      // Локальное хранилище для разработки\n      localStorage.setItem(key, serializedData);\n    }\n    return true;\n  } catch (error) {\n    console.error('Ошибка сохранения данных:', error);\n    return false;\n  }\n};\n\nexport const loadUserData = async (userId) => {\n  try {\n    const key = `vl_${userId}`;\n\n    // Используем Telegram Cloud Storage если доступен\n    if (window.Telegram?.WebApp?.CloudStorage) {\n      const value = await new Promise((resolve, reject) => {\n        window.Telegram.WebApp.CloudStorage.getItem(key, (error, result) => {\n          if (error) {\n            reject(error);\n          } else {\n            resolve(result);\n          }\n        });\n      });\n      return value ? JSON.parse(value) : null;\n    }\n    \n    // Локальное хранилище для разработки\n    const localData = localStorage.getItem(key);\n    return localData ? JSON.parse(localData) : null;\n  } catch (error) {\n    console.error('Ошибка загрузки данных:', error);\n    return null;\n  }\n};"],"mappings":"AAAA;AACA,MAAO,MAAM,CAAAA,YAAY,CAAG,KAAAA,CAAOC,MAAM,CAAEC,IAAI,GAAK,CAClD,GAAI,KAAAC,gBAAA,CAAAC,qBAAA,CACF,KAAM,CAAAC,GAAG,OAAAC,MAAA,CAASL,MAAM,CAAE,CAC1B,KAAM,CAAAM,cAAc,CAAGC,IAAI,CAACC,SAAS,CAACP,IAAI,CAAC,CAE3C;AACA,IAAAC,gBAAA,CAAIO,MAAM,CAACC,QAAQ,UAAAR,gBAAA,YAAAC,qBAAA,CAAfD,gBAAA,CAAiBS,MAAM,UAAAR,qBAAA,WAAvBA,qBAAA,CAAyBS,YAAY,CAAE,CACzC,KAAM,IAAI,CAAAC,OAAO,CAAC,CAACC,OAAO,CAAEC,MAAM,GAAK,CACrCN,MAAM,CAACC,QAAQ,CAACC,MAAM,CAACC,YAAY,CAACI,OAAO,CAACZ,GAAG,CAAEE,cAAc,CAAGW,KAAK,EAAK,CAC1E,GAAIA,KAAK,CAAE,CACTF,MAAM,CAACE,KAAK,CAAC,CACf,CAAC,IAAM,CACLH,OAAO,CAAC,CAAC,CACX,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CACJ,CAAC,IAAM,CACL;AACAI,YAAY,CAACF,OAAO,CAACZ,GAAG,CAAEE,cAAc,CAAC,CAC3C,CACA,MAAO,KAAI,CACb,CAAE,MAAOW,KAAK,CAAE,CACdE,OAAO,CAACF,KAAK,CAAC,2BAA2B,CAAEA,KAAK,CAAC,CACjD,MAAO,MAAK,CACd,CACF,CAAC,CAED,MAAO,MAAM,CAAAG,YAAY,CAAG,KAAO,CAAApB,MAAM,EAAK,CAC5C,GAAI,KAAAqB,iBAAA,CAAAC,qBAAA,CACF,KAAM,CAAAlB,GAAG,OAAAC,MAAA,CAASL,MAAM,CAAE,CAE1B;AACA,IAAAqB,iBAAA,CAAIZ,MAAM,CAACC,QAAQ,UAAAW,iBAAA,YAAAC,qBAAA,CAAfD,iBAAA,CAAiBV,MAAM,UAAAW,qBAAA,WAAvBA,qBAAA,CAAyBV,YAAY,CAAE,CACzC,KAAM,CAAAW,KAAK,CAAG,KAAM,IAAI,CAAAV,OAAO,CAAC,CAACC,OAAO,CAAEC,MAAM,GAAK,CACnDN,MAAM,CAACC,QAAQ,CAACC,MAAM,CAACC,YAAY,CAACY,OAAO,CAACpB,GAAG,CAAE,CAACa,KAAK,CAAEQ,MAAM,GAAK,CAClE,GAAIR,KAAK,CAAE,CACTF,MAAM,CAACE,KAAK,CAAC,CACf,CAAC,IAAM,CACLH,OAAO,CAACW,MAAM,CAAC,CACjB,CACF,CAAC,CAAC,CACJ,CAAC,CAAC,CACF,MAAO,CAAAF,KAAK,CAAGhB,IAAI,CAACmB,KAAK,CAACH,KAAK,CAAC,CAAG,IAAI,CACzC,CAEA;AACA,KAAM,CAAAI,SAAS,CAAGT,YAAY,CAACM,OAAO,CAACpB,GAAG,CAAC,CAC3C,MAAO,CAAAuB,SAAS,CAAGpB,IAAI,CAACmB,KAAK,CAACC,SAAS,CAAC,CAAG,IAAI,CACjD,CAAE,MAAOV,KAAK,CAAE,CACdE,OAAO,CAACF,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/C,MAAO,KAAI,CACb,CACF,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}